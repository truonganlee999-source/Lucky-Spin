<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucky Wheel - Spin & Win</title>
    
    <!-- 1. Tailwind CSS (Styling) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. FontAwesome (Icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- 3. Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">

    <!-- 4. Confetti Effect -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        body { font-family: 'Poppins', sans-serif; }
        
        /* Custom Shadows */
        .wheel-container {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5), inset 0 0 20px rgba(0,0,0,0.2);
        }
        
        /* Modal Animation */
        .modal-enter { animation: modalPop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes modalPop {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-900 via-purple-800 to-pink-700 min-h-screen flex flex-col items-center justify-center text-white overflow-hidden p-4">

    <!-- HEADER -->
    <div class="text-center mb-8 z-10">
        <div class="inline-block bg-white/20 backdrop-blur-md px-4 py-1 rounded-full text-xs font-bold mb-2 border border-white/20 uppercase tracking-widest">
            ✨ Special Event
        </div>
        <h1 class="text-4xl md:text-6xl font-black drop-shadow-2xl uppercase text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-orange-500">
            LUCKY<br>WHEEL
        </h1>
        <p class="text-white/70 mt-2 text-sm md:text-base">Spin the wheel - Get your reward!</p>
    </div>

    <!-- WHEEL CONTAINER -->
    <div class="relative z-10 group">
        <!-- Pointer (Triangle) -->
        <div class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-6 z-20 drop-shadow-lg">
            <i class="fa-solid fa-location-dot text-5xl text-red-500"></i>
        </div>
        
        <!-- Canvas Wheel -->
        <div class="wheel-container rounded-full border-8 border-white/10 p-2 bg-white/5 backdrop-blur-sm">
            <canvas id="wheelCanvas" width="340" height="340" class="rounded-full transition-transform duration-[4000ms] ease-[cubic-bezier(0.25,0.1,0.25,1)]"></canvas>
        </div>
        
        <!-- Center Cap -->
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-white rounded-full shadow-inner flex items-center justify-center border-4 border-purple-200 z-10">
            <i class="fa-solid fa-gift text-2xl text-purple-600 animate-pulse"></i>
        </div>
    </div>

    <!-- ACTION BUTTON -->
    <button id="spinBtn" class="mt-10 relative inline-flex items-center justify-center px-12 py-4 text-xl font-black text-white transition-all duration-200 bg-gradient-to-r from-yellow-400 to-orange-600 rounded-full focus:outline-none hover:scale-105 shadow-[0_0_20px_rgba(255,165,0,0.5)] z-10">
        <span class="mr-2">SPIN NOW</span>
        <i class="fa-solid fa-play"></i>
    </button>

    <!-- FOOTER -->
    <p class="mt-8 text-xs text-white/40">Powered by YourBrand © 2025</p>

    <!-- RESULT MODAL (Hidden by default) -->
    <div id="resultModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm hidden">
        <div class="bg-white text-gray-800 rounded-3xl p-6 w-full max-w-sm mx-4 text-center shadow-2xl modal-enter border-4 border-yellow-400 relative">
            
            <!-- Close Button -->
            <button onclick="closeModal()" class="absolute top-3 right-3 text-gray-400 hover:text-gray-600 transition">
                <i class="fa-solid fa-xmark text-2xl"></i>
            </button>

            <!-- Trophy Icon -->
            <div class="w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-3 text-yellow-500 text-4xl shadow-inner">
                <i class="fa-solid fa-trophy"></i>
            </div>

            <h2 class="text-xl font-bold text-gray-900 uppercase">CONGRATULATIONS!</h2>
            <p class="text-gray-500 text-sm">You have won:</p>
            
            <!-- Winning Result Text -->
            <div id="prizeResult" class="text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 my-4 py-2 border-b border-dashed border-gray-200">
                ...
            </div>
            
            <p class="text-xs text-gray-400 mb-3">Choose how to claim your prize:</p>

            <!-- ACTION BUTTONS -->
            <div class="flex flex-col gap-3">
                <!-- WhatsApp Button -->
                <a id="waLink" href="#" target="_blank" class="flex items-center justify-center gap-3 w-full bg-[#25D366] hover:bg-[#1ebc57] text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-transform hover:-translate-y-1">
                    <i class="fa-brands fa-whatsapp text-2xl"></i>
                    <span>Claim via WhatsApp</span>
                </a>

                <!-- SMS Button -->
                <a id="smsLink" href="#" class="flex items-center justify-center gap-3 w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg transition-transform hover:-translate-y-1">
                    <i class="fa-solid fa-comment-sms text-xl"></i>
                    <span>Claim via SMS</span>
                </a>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        /* ================= CONFIGURATION (EDIT HERE) ================= */
        
        // Your Phone Number
        // Tip: For WhatsApp, it's best to use International Format without '+' (e.g., 84912345678)
        const SHOP_PHONE_NUMBER = "84912345678"; 
        
        // Prize List & Probability (Percent)
        // Ensure 'percent' values sum up roughly to 100 (or logic will handle it)
        // percent: 0 means impossible to win.
        const PRIZES = [
            { label: "10% OFF",   color: "#FF6B6B", text: "#FFF", percent: 40 }, // 40% Chance
            { label: "Free Ship", color: "#4ECDC4", text: "#FFF", percent: 30 }, // 30% Chance
            { label: "Gift Box",  color: "#FFE66D", text: "#555", percent: 5 },  // 5% Chance (Rare)
            { label: "Good Luck", color: "#d1d5db", text: "#555", percent: 25 }, // 25% Miss
            { label: "50% OFF",   color: "#FF9F43", text: "#FFF", percent: 0 },  // 0% (Impossible)
            { label: "Jackpot",   color: "#9B59B6", text: "#FFF", percent: 0 },  // 0% (Impossible)
        ];

        /* ============================================================= */

        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');
        const modal = document.getElementById('resultModal');
        const prizeResultText = document.getElementById('prizeResult');
        const smsLinkBtn = document.getElementById('smsLink');
        const waLinkBtn = document.getElementById('waLink');

        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const radius = canvas.width / 2;
        const PI = Math.PI;
        const TAU = 2 * PI;
        const arc = TAU / PRIZES.length;

        let currentRotation = 0;

        // --- 1. DRAW WHEEL ---
        function drawWheel() {
            PRIZES.forEach((prize, i) => {
                const angle = i * arc - PI / 2; 
                
                // Draw Segment
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, angle, angle + arc);
                ctx.fillStyle = prize.color;
                ctx.fill();
                ctx.lineWidth = 2;
                ctx.strokeStyle = "#ffffff";
                ctx.stroke();

                // Draw Text
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(angle + arc / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = prize.text;
                ctx.font = "bold 15px Poppins";
                ctx.fillText(prize.label, radius - 20, 5);
                ctx.restore();
            });
        }
        drawWheel(); // Initial Render

        // --- 2. WEIGHTED RANDOM LOGIC ---
        function getWeightedWinner() {
            const totalWeight = PRIZES.reduce((sum, prize) => sum + prize.percent, 0);
            let random = Math.random() * totalWeight;
            
            for (let i = 0; i < PRIZES.length; i++) {
                if (random < PRIZES[i].percent) return i;
                random -= PRIZES[i].percent;
            }
            return 0;
        }

        // --- 3. SPIN HANDLER ---
        spinBtn.addEventListener('click', () => {
            // Disable button immediately
            spinBtn.disabled = true;
            spinBtn.classList.add('opacity-50', 'cursor-not-allowed');
            spinBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i> SPINNING...';

            const winningIndex = getWeightedWinner();
            
            // Calculate Rotation
            const segmentAngle = 360 / PRIZES.length;
            const randomOffset = (Math.random() * segmentAngle * 0.8) - (segmentAngle * 0.4);
            const winningAnglePosition = winningIndex * segmentAngle; 
            
            // Spin 5 times (1800deg) + Angle to target
            const targetRotation = (360 * 5) + (360 - winningAnglePosition) + randomOffset;
            const currentMod = currentRotation % 360;
            currentRotation = currentRotation - currentMod + targetRotation;

            // Apply CSS Transform
            canvas.style.transform = `rotate(${currentRotation}deg)`;

            // Wait for animation (4s)
            setTimeout(() => {
                showResult(PRIZES[winningIndex].label);
                
                // Update Button State to "Claimed"
                spinBtn.innerHTML = '<i class="fa-solid fa-check mr-2"></i> CLAIMED';
            }, 4000);
        });

        // --- 4. SHOW RESULT & GENERATE LINKS ---
        function showResult(prizeName) {
            prizeResultText.innerText = prizeName;

            // Confetti Effect (Only if it's not a "Miss")
            if (!prizeName.toLowerCase().includes("good luck") && !prizeName.toLowerCase().includes("try again")) {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            }

            // Message Content
            const message = `Hello Shop, I just won [${prizeName}] on the Lucky Wheel. Please claim my reward!`;
            const encodedMsg = encodeURIComponent(message);
            
            // --- A. SMS LINK ---
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const delimiter = isIOS ? '&' : '?';
            smsLinkBtn.href = `sms:${SHOP_PHONE_NUMBER}${delimiter}body=${encodedMsg}`;

            // --- B. WHATSAPP LINK ---
            // Ensure phone number is clean (no spaces, no +)
            let waPhone = SHOP_PHONE_NUMBER.replace(/\D/g, ''); 
            waLinkBtn.href = `https://wa.me/${waPhone}?text=${encodedMsg}`;

            // Show Modal
            modal.classList.remove('hidden');
        }

        function closeModal() {
            modal.classList.add('hidden');
        }
    </script>
</body>
</html>
